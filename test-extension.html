<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extension Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .test-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        #test-button {
            padding: 15px 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            margin: 20px 0;
        }
        
        #test-button:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <div class="test-content">
        <h1>ðŸ§ª Extension UI Test</h1>
        <p>This page simulates how the Chrome extension overlay would appear.</p>
        <p>Click the button below to trigger the overlay with blurry background effect.</p>
        
        <button id="test-button">Test Extension Overlay</button>
        
        <div style="margin-top: 30px;">
            <h3>Background Content</h3>
            <p>This is sample content that should be blurred when the overlay appears.</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
        </div>
    </div>

    <!-- Load React -->
    <script src="/dist/js/react.production.min.js"></script>
    <script src="/dist/js/react-dom.production.min.js"></script>
    
    <!-- Load App -->
    <script src="/dist/App.js"></script>
    
    <script>
        document.getElementById('test-button').addEventListener('click', function() {
            console.log('Testing extension overlay...');
            
            // Simulate the extension injection
            injectExtensionOverlay();
        });
        
        function injectExtensionOverlay() {
            // Check if overlay already exists
            if (document.getElementById('subtitle-extension-overlay')) {
                return;
            }
            
            // Create the overlay container (like in content-script.js)
            const overlay = document.createElement('div');
            overlay.id = 'subtitle-extension-overlay';
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
                background-color: rgba(20, 20, 20, 0.8);
                backdrop-filter: blur(12px);
                -webkit-backdrop-filter: blur(12px);
                z-index: 2147483647;
                display: flex;
                align-items: center;
                justify-content: center;
                font-family: 'Inter', sans-serif;
            `;
            
            // Create the React root container
            const reactRoot = document.createElement("div");
            reactRoot.id = "subtitle-extension-root";
            reactRoot.style.cssText = `
                display: flex;
                align-items: center;
                justify-content: center;
                max-width: 90vw;
                max-height: 90vh;
            `;
            
            // Assemble the overlay
            overlay.appendChild(reactRoot);
            
            // Add to page
            document.body.appendChild(overlay);
            
            // Close on ESC key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && document.getElementById('subtitle-extension-overlay')) {
                    overlay.remove();
                }
            });
            
            // Close on click outside
            overlay.addEventListener('click', function(e) {
                if (e.target === overlay) {
                    overlay.remove();
                }
            });
            
            // Render the React app
            if (window.React && window.ReactDOM && window.App) {
                const root = window.ReactDOM.createRoot(reactRoot);
                root.render(window.React.createElement(window.App));
            } else {
                // Fallback if React or App not available
                reactRoot.innerHTML = `
                    <div style="
                        padding: 40px;
                        background: rgba(255, 255, 255, 0.95);
                        border-radius: 12px;
                        text-align: center;
                        max-width: 500px;
                        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                    ">
                        <h2 style="color: #333; margin: 0 0 20px 0;">ðŸ“± Subtitle Extension</h2>
                        <p style="color: #666; margin: 0 0 20px 0;">Extension overlay is working!</p>
                        <p style="font-size: 14px; color: #999;">Press ESC to close</p>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>